---
- name: Main/Base Config
  hosts: all
  become: true
  tasks:
    - name: "Copy externally generate public SSH key"
      ansible.posix.authorized_key:
        user: vagrant
        key: "{{ lookup('file', lookup('env', 'HOME') + '/.ssh/vagrant-k8s-experiments.pub') }}"
        exclusive: true
    - name: "Obtain kubernetes apt gpg key"
      ansible.builtin.get_url:
        url: "https://packages.cloud.google.com/apt/doc/apt-key.gpg"
        dest: "/usr/share/keyrings/kubernetes-archive-keyring.gpg"
        mode: 0644
